<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nilabja & Cynthea | Save The Date</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/lenis@1.1.13/dist/lenis.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Montserrat:wght@100;300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --maroon: #4a0404;
            --gold: #d4af37;
            --cream: #fdfaf5;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: #0f0f0f;
            margin: 0;
            overflow: hidden;
            cursor: crosshair;
            /* Prevent default touch behaviors that might interfere with Lenis */
            touch-action: none;
        }

        .font-serif { font-family: 'Playfair Display', serif; }

        /* Mobile Frame Styling */
        .viewport-wrapper {
            width: 100%;
            height: 100vh;
            height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-frame {
            width: 100%;
            max-width: 430px;
            height: 100%;
            background: var(--cream);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 150px rgba(0,0,0,0.9);
            color: #2a2a2a;
            display: flex;
            flex-direction: column;
        }

        @media (min-width: 640px) {
            .mobile-frame {
                height: 880px;
                max-height: 92vh;
                border-radius: 3rem;
                border: 10px solid #1a1a1a;
            }
        }

        /* Card Flap Shapes */
        .card-flap-top {
            clip-path: polygon(0 0, 100% 0, 100% 100%, 50% 85%, 0 100%);
        }
        .card-flap-bottom {
            clip-path: polygon(0 0, 50% 15%, 100% 0, 100% 100%, 0 100%);
        }

        /* Smooth Scroll Container */
        #scroll-wrapper {
            height: 100%;
            width: 100%;
            overflow: hidden;
            -ms-overflow-style: none;
            scrollbar-width: none;
            /* Allow vertical panning for touch devices */
            touch-action: pan-y;
        }

        ::-webkit-scrollbar { width: 0; }

        .parallax-img { transform: scale(1.15); }

        /* Animation States */
        .card-overlay {
            position: absolute;
            inset: 0;
            z-index: 200;
            display: flex;
            flex-direction: column;
            pointer-events: auto;
        }

        .seal-btn {
            animation: pulse-gold 2s infinite ease-in-out;
        }

        @keyframes pulse-gold {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(212, 175, 55, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(212, 175, 55, 0.6); }
        }

        canvas#three-bg {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.4;
        }
    </style>
</head>
<body>

    <canvas id="three-bg"></canvas>

    <div class="viewport-wrapper">
        <div class="mobile-frame" id="main-frame">
            
            <!-- Cinematic Card Overlay -->
            <div class="card-overlay" id="cardOverlay">
                <div class="card-flap-top flex-1 bg-[#4a0404] border-b border-[#d4af37]/30 relative overflow-hidden">
                    <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/paper-fibers.png')]"></div>
                </div>
                
                <div class="card-seal absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[210] flex flex-col items-center" id="cardSeal">
                    <div onclick="openInvitation()" class="seal-btn w-24 h-24 bg-[#d4af37] rounded-full shadow-2xl flex items-center justify-center cursor-pointer group transition-transform">
                        <div class="w-20 h-20 border border-white/30 rounded-full flex items-center justify-center">
                            <span class="text-white font-serif italic text-sm tracking-widest group-hover:animate-pulse">Open</span>
                        </div>
                    </div>
                    <p class="mt-6 text-[#d4af37] font-serif italic text-lg opacity-80 animate-bounce">Nilabja & Cynthea</p>
                </div>

                <div class="card-flap-bottom flex-1 bg-[#4a0404] border-t border-[#d4af37]/30 relative overflow-hidden">
                    <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/paper-fibers.png')]"></div>
                </div>
            </div>

            <!-- Global UI Controls (Sticky) -->
            <div class="absolute top-10 left-8 right-8 z-[100] flex justify-between items-center mix-blend-difference">
                <button onclick="toggleMute()" class="text-white/80 hover:text-[#d4af37] transition-all" id="muteBtn">
                    <i data-lucide="volume-x" class="w-4 h-4" stroke-width="1"></i>
                </button>
                <div class="flex items-center gap-4">
                    <span class="text-[6px] tracking-[0.5em] text-white/40 uppercase font-light">3rd Feb 2026</span>
                    <i data-lucide="share-2" class="w-3 h-3 text-white/60" stroke-width="1"></i>
                </div>
            </div>

            <!-- Smooth Scroll Area -->
            <div id="scroll-wrapper">
                <div class="scroll-content">
                    
                    <!-- HERO SECTION -->
                    <section class="h-screen relative flex flex-col justify-end px-12 pb-24 overflow-hidden">
                        <div class="absolute inset-0 z-0 overflow-hidden">
                            <div class="absolute inset-0 bg-gradient-to-t from-[#fdfaf5] via-[#fdfaf5]/20 to-transparent z-10"></div>
                            <img src="https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=2070&auto=format&fit=crop" 
                                 class="w-full h-full object-cover opacity-10 filter sepia-[0.5]" alt="Mandap">
                        </div>

                        <div class="relative z-20 hero-reveal">
                            <div class="mb-8 anim-item">
                                <span class="text-[#4a0404] text-[9px] tracking-[0.6em] uppercase font-bold block mb-4 border-l-2 border-[#d4af37] pl-4">Shuvokho</span>
                                <p class="text-[#d4af37] font-serif italic text-lg ml-4">Seeking your blessings for...</p>
                            </div>
                            
                            <h1 class="font-serif text-[4.8rem] leading-[0.8] text-[#4a0404] tracking-tight anim-item">
                                Nilabja<br><span class="italic text-[#d4af37]">&</span><br>Cynthea
                            </h1>
                            
                            <div class="mt-12 flex gap-10 items-end anim-item">
                                <div class="text-center">
                                    <span class="block text-3xl font-serif text-[#4a0404]" id="days">00</span>
                                    <span class="text-[7px] tracking-widest text-[#d4af37] font-bold block uppercase mt-1">Days</span>
                                </div>
                                <div class="w-[1px] h-10 bg-[#d4af37]/20"></div>
                                <div class="text-center">
                                    <span class="block text-3xl font-serif text-[#4a0404]" id="hours">00</span>
                                    <span class="text-[7px] tracking-widest text-[#d4af37] font-bold block uppercase mt-1">Hours</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- PORTRAIT SECTION -->
                    <section class="reveal-section py-40 px-10 bg-white relative">
                        <div class="parallax-wrap aspect-[3/4] rounded-t-full rounded-b-3xl overflow-hidden shadow-2xl mb-20 relative">
                            <img src="https://images.unsplash.com/photo-1511285560929-80b456fea0bc?q=80&w=2069&auto=format&fit=crop" 
                                 class="w-full h-full object-cover parallax-img" alt="Couple">
                            <div class="absolute inset-0 bg-gradient-to-t from-[#4a0404]/30 to-transparent"></div>
                        </div>
                        
                        <div class="anim-up text-center space-y-8">
                            <i data-lucide="sparkles" class="mx-auto text-[#d4af37] w-5 h-5" stroke-width="1"></i>
                            <h2 class="font-serif text-3xl italic text-[#4a0404] leading-snug px-4">
                                "Our story, written in ink of tradition and heart of gold."
                            </h2>
                            <div class="h-px w-8 bg-[#d4af37] mx-auto opacity-30"></div>
                            <p class="text-[10px] leading-relaxed text-slate-400 uppercase tracking-[0.5em] font-light px-8">
                                From the sound of the shankh to the seven steps of forever.
                            </p>
                        </div>
                    </section>

                    <!-- RITUALS GRID -->
                    <section class="reveal-section py-40 px-12 bg-[#4a0404] text-[#d4af37] relative overflow-hidden">
                        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/padded-light.png')]"></div>
                        
                        <div class="relative z-10 space-y-24">
                            <div class="anim-up">
                                <p class="text-[8px] tracking-[0.6em] uppercase opacity-40 font-bold mb-4">Celebration Timeline</p>
                                <h3 class="font-serif italic text-6xl text-white/90">Rituals</h3>
                            </div>

                            <div class="space-y-16 anim-up">
                                <div class="flex justify-between items-end border-b border-[#d4af37]/20 pb-6">
                                    <div>
                                        <span class="text-[7px] uppercase tracking-widest opacity-30 block mb-2 font-bold">The Arrival</span>
                                        <p class="font-serif text-2xl text-white">Bor Jatri</p>
                                    </div>
                                    <p class="text-[10px] font-bold">6:00 PM</p>
                                </div>
                                <div class="flex justify-between items-end border-b border-[#d4af37]/20 pb-6">
                                    <div>
                                        <span class="text-[7px] uppercase tracking-widest opacity-30 block mb-2 font-bold">The Union</span>
                                        <p class="font-serif text-2xl text-white">Sat Paak & Biye</p>
                                    </div>
                                    <p class="text-[10px] font-bold">8:30 PM</p>
                                </div>
                                <div class="flex justify-between items-end border-b border-[#d4af37]/20 pb-6">
                                    <div>
                                        <span class="text-[7px] uppercase tracking-widest opacity-30 block mb-2 font-bold">The Feast</span>
                                        <p class="font-serif text-2xl text-white">Bhojon Utsav</p>
                                    </div>
                                    <p class="text-[10px] font-bold">9:30 PM</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- VENUE SECTION -->
                    <section class="reveal-section py-40 px-12 bg-[#fdfaf5]">
                        <div class="space-y-20">
                            <div class="anim-up relative">
                                <i data-lucide="map-pin" class="text-[#d4af37] w-6 h-6 mb-8" stroke-width="1"></i>
                                <h4 class="font-serif text-4xl text-[#4a0404] mb-4">Royal Heritage Palace</h4>
                                <p class="text-[10px] text-slate-400 uppercase tracking-widest leading-loose mb-10">
                                    Salt Lake Sector V, Kolkata <br> West Bengal 700091
                                </p>
                                <button class="px-10 py-5 bg-[#4a0404] text-white text-[8px] tracking-[0.5em] uppercase font-bold rounded-full shadow-2xl hover:scale-105 transition-transform">
                                    Get Directions
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- CLOSING -->
                    <section class="reveal-section py-48 px-12 text-center bg-white">
                        <i data-lucide="heart" class="mx-auto text-[#d4af37] w-8 h-8 mb-12 anim-up" stroke-width="0.5"></i>
                        <h2 class="anim-up font-serif italic text-4xl text-[#4a0404] mb-12 leading-snug">Together with <br> our families.</h2>
                        <div class="w-8 h-[1px] bg-[#d4af37] mx-auto mb-12 anim-up opacity-30"></div>
                        <p class="anim-up text-[9px] tracking-[0.6em] uppercase text-slate-400 font-bold mb-20">The Mukherjee & Sen Families</p>
                        
                        <div class="mt-20 pt-16 border-t border-[#4a0404]/5 anim-up">
                            <span class="font-serif italic text-4xl text-[#d4af37]">N & C</span>
                        </div>
                    </section>

                    <footer class="py-12 bg-white text-center">
                        <p class="text-[6px] tracking-[0.4em] uppercase text-slate-300">A World-Class Design Studio Presentation â€¢ 2026</p>
                    </footer>
                </div>
            </div>

            <!-- Device Aesthetic Edge -->
            <div class="absolute inset-0 pointer-events-none border-[1px] border-black/5 rounded-[3rem] sm:block hidden shadow-inner z-[300]"></div>
        </div>
    </div>

    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // Mute state
        let isMuted = true;
        const muteBtn = document.getElementById('muteBtn');

        function toggleMute() {
            isMuted = !isMuted;
            muteBtn.innerHTML = isMuted ? 
                '<i data-lucide="volume-x" class="w-4 h-4" stroke-width="1"></i>' : 
                '<i data-lucide="volume-2" class="w-4 h-4" stroke-width="1"></i>';
            lucide.createIcons();
        }

        // Countdown Logic
        const targetDate = new Date('February 3, 2026 19:30:00').getTime();
        function updateTimer() {
            const now = new Date().getTime();
            const diff = targetDate - now;
            if (diff > 0) {
                document.getElementById('days').innerText = String(Math.floor(diff / (1000 * 60 * 60 * 24))).padStart(2, '0');
                document.getElementById('hours').innerText = String(Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))).padStart(2, '0');
            }
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // THREE.JS Particles (Gold Dust)
        let scene, camera, renderer, particles;

        function initThree() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, 430 / 900, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('three-bg'), alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);

            const particlesCount = 1200;
            const posArray = new Float32Array(particlesCount * 3);
            for(let i=0; i < particlesCount * 3; i++) {
                posArray[i] = (Math.random() - 0.5) * 10;
            }
            const geometry = new THREE.BufferGeometry();
            geometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            const material = new THREE.PointsMaterial({ size: 0.012, color: 0xd4af37, transparent: true, opacity: 0.5 });
            particles = new THREE.Points(geometry, material);
            scene.add(particles);
            camera.position.z = 3;

            function animate() {
                requestAnimationFrame(animate);
                particles.rotation.y += 0.001;
                particles.rotation.x += 0.0005;
                renderer.render(scene, camera);
            }
            animate();

            window.addEventListener('resize', () => {
                renderer.setSize(window.innerWidth, window.innerHeight);
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
            });
        }

        initThree();

        // Card Opening Logic
        function openInvitation() {
            const tl = gsap.timeline({
                onComplete: () => {
                    document.getElementById('cardOverlay').style.display = 'none';
                    initLenisAndScroll();
                }
            });

            tl.to(".card-flap-top", { yPercent: -100, duration: 1.5, ease: "expo.inOut" })
              .to(".card-flap-bottom", { yPercent: 100, duration: 1.5, ease: "expo.inOut" }, "<")
              .to(".card-seal", { scale: 0, opacity: 0, duration: 0.5 }, "<")
              .to("#cardOverlay", { opacity: 0, duration: 1 });
        }

        // Lenis and GSAP Scroll
        function initLenisAndScroll() {
            gsap.registerPlugin(ScrollTrigger);

            const lenis = new Lenis({
                wrapper: document.getElementById('scroll-wrapper'),
                content: document.querySelector('.scroll-content'),
                duration: 1.4,
                easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
                // Ensure touch support is handled correctly for mobile
                smoothTouch: true,
                touchMultiplier: 1.5,
                infinite: false
            });

            function raf(time) {
                lenis.raf(time);
                requestAnimationFrame(raf);
            }
            requestAnimationFrame(raf);
            
            // Sync GSAP with Lenis
            lenis.on('scroll', ScrollTrigger.update);
            
            // Allow Lenis to handle wheel/touch events on the wrapper
            gsap.ticker.add((time) => {
              lenis.raf(time * 1000);
            });
            gsap.ticker.lagSmoothing(0);

            // Hero Animation
            gsap.from(".hero-reveal .anim-item", {
                y: 80,
                opacity: 0,
                stagger: 0.2,
                duration: 1.8,
                ease: "expo.out",
                delay: 0.2
            });

            // Reveal Sections
            gsap.utils.toArray(".reveal-section").forEach(section => {
                gsap.from(section.querySelectorAll(".anim-up"), {
                    scrollTrigger: {
                        trigger: section,
                        scroller: "#scroll-wrapper",
                        start: "top 85%",
                    },
                    y: 60,
                    opacity: 0,
                    duration: 1.5,
                    stagger: 0.2,
                    ease: "power4.out"
                });
            });

            // Parallax
            gsap.to(".parallax-img", {
                scrollTrigger: {
                    trigger: ".parallax-wrap",
                    scroller: "#scroll-wrapper",
                    scrub: true,
                    start: "top bottom",
                    end: "bottom top"
                },
                yPercent: -20,
                scale: 1.15,
                ease: "none"
            });
        }
    </script>
</body>
</html>
